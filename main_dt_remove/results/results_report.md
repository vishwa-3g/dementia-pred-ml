# Final Model Performances

## Training set performance

model    selection     embed_selector      acc    auroc    bal-acc     f1      npv    ppv    sens    spec
-------  ------------  ----------------  -----  -------  ---------  -----  -------  -----  ------  ------
knn      wrap          none              1.000    1.000      1.000  1.000    1.000  1.000   1.000   1.000
knn      none          none              1.000    1.000      1.000  1.000    1.000  1.000   1.000   1.000
lgbm     pred          none              0.972    0.997      0.972  0.972    0.983  0.962   0.972   0.959
rf       embed_linear  linear            0.952    0.993      0.951  0.952    0.978  0.930   0.951   0.922
rf       assoc         none              0.944    0.986      0.943  0.944    0.965  0.926   0.943   0.918
gandalf  none          none              0.914    0.973      0.915  0.914    0.882  0.950   0.915   0.951
rf       pred          none              0.910    0.973      0.909  0.910    0.938  0.887   0.909   0.872
rf       none          none              0.908    0.965      0.907  0.908    0.926  0.892   0.907   0.881
lgbm     embed_linear  linear            0.900    0.966      0.899  0.900    0.921  0.882   0.899   0.868
lgbm     assoc         none              0.894    0.966      0.893  0.894    0.913  0.878   0.893   0.864
lgbm     none          none              0.890    0.955      0.889  0.890    0.920  0.866   0.889   0.848
gandalf  pred          none              0.860    0.944      0.858  0.859    0.899  0.830   0.858   0.802
rf       embed_lgbm    lgbm              0.856    0.943      0.856  0.856    0.841  0.871   0.856   0.868
gandalf  assoc         none              0.838    0.938      0.839  0.838    0.805  0.876   0.839   0.881
gandalf  embed_linear  linear            0.826    0.930      0.827  0.826    0.795  0.860   0.827   0.864
lr       embed_linear  linear            0.822    0.914      0.821  0.821    0.847  0.802   0.821   0.774
lr       assoc         none              0.818    0.914      0.816  0.817    0.852  0.792   0.816   0.757
lr       none          none              0.814    0.914      0.812  0.813    0.847  0.789   0.812   0.753
lr       pred          none              0.812    0.910      0.810  0.811    0.847  0.786   0.810   0.749
lgbm     embed_lgbm    lgbm              0.802    0.909      0.802  0.802    0.783  0.821   0.802   0.819
sgd      none          none              0.798    0.844      0.798  0.798    0.789  0.807   0.798   0.798
sgd      embed_linear  linear            0.784    0.784      0.784  0.784    0.776  0.792   0.784   0.782
sgd      assoc         none              0.780    0.857      0.780  0.780    0.769  0.791   0.780   0.782
sgd      pred          none              0.780    0.853      0.780  0.780    0.774  0.786   0.780   0.774
lgbm     wrap          none              0.770    0.848      0.763  0.754    1.000  0.691   0.763   0.527
rf       wrap          none              0.770    0.856      0.763  0.754    1.000  0.691   0.763   0.527
lr       wrap          none              0.770    0.801      0.763  0.754    1.000  0.691   0.763   0.527
knn      assoc         none              0.722    0.784      0.722  0.722    0.711  0.732   0.722   0.720
sgd      wrap          none              0.694    0.719      0.693  0.693    0.692  0.695   0.693   0.667
lr       embed_lgbm    lgbm              0.682    0.740      0.687  0.675    0.627  0.788   0.687   0.852
sgd      embed_lgbm    lgbm              0.658    0.697      0.658  0.658    0.645  0.671   0.658   0.658
gandalf  embed_lgbm    lgbm              0.628    0.689      0.627  0.627    0.626  0.630   0.627   0.584
knn      pred          none              0.614    0.688      0.612  0.610    0.620  0.610   0.612   0.531
knn      embed_lgbm    lgbm              0.596    0.614      0.593  0.591    0.602  0.592   0.593   0.498
knn      embed_linear  linear            0.594    0.631      0.593  0.592    0.588  0.599   0.593   0.547
dummy    pred          none              0.514    0.500      0.500  0.339  nan      0.514   0.500   0.000
dummy    none          none              0.514    0.500      0.500  0.339  nan      0.514   0.500   0.000
dummy    assoc         none              0.514    0.500      0.500  0.339  nan      0.514   0.500   0.000
gandalf  wrap          none              0.508    0.794      0.521  0.390    0.497  0.739   0.521   0.975
dummy    embed_lgbm    lgbm              0.504    0.500      0.504  0.504    0.490  0.518   0.504   0.510
dummy    wrap          none              0.504    0.500      0.504  0.504    0.490  0.518   0.504   0.490
dummy    embed_linear  linear            0.456    0.523      0.456  0.456    0.441  0.471   0.456   0.444

## Holdout set performance

model    selection     embed_selector      acc    auroc    bal-acc     f1      npv    ppv    sens    spec
-------  ------------  ----------------  -----  -------  ---------  -----  -------  -----  ------  ------
lgbm     assoc         none              0.766    0.870      0.765  0.766    0.766  0.766   0.765   0.744
lgbm     none          none              0.764    0.873      0.763  0.763    0.770  0.759   0.763   0.731
lgbm     embed_linear  linear            0.764    0.862      0.763  0.763    0.777  0.754   0.763   0.719
rf       assoc         none              0.764    0.873      0.764  0.764    0.758  0.769   0.764   0.752
gandalf  pred          none              0.758    0.868      0.757  0.757    0.760  0.757   0.757   0.731
rf       embed_linear  linear            0.754    0.861      0.752  0.752    0.782  0.734   0.752   0.682
rf       pred          none              0.752    0.866      0.751  0.751    0.757  0.748   0.751   0.719
rf       none          none              0.752    0.863      0.752  0.752    0.744  0.760   0.752   0.744
lr       wrap          none              0.750    0.765      0.742  0.728    1.000  0.674   0.742   0.483
lgbm     wrap          none              0.750    0.756      0.742  0.728    1.000  0.674   0.742   0.483
rf       wrap          none              0.750    0.745      0.742  0.728    1.000  0.674   0.742   0.483
lgbm     pred          none              0.748    0.854      0.747  0.748    0.744  0.752   0.747   0.731
lr       embed_linear  linear            0.748    0.869      0.746  0.747    0.761  0.737   0.746   0.698
lr       assoc         none              0.746    0.870      0.744  0.745    0.760  0.735   0.744   0.694
lr       none          none              0.744    0.869      0.742  0.743    0.759  0.732   0.742   0.690
sgd      pred          none              0.742    0.815      0.742  0.742    0.723  0.761   0.742   0.756
lr       pred          none              0.740    0.866      0.738  0.737    0.769  0.719   0.738   0.661
sgd      embed_linear  linear            0.732    0.733      0.733  0.732    0.709  0.756   0.733   0.756
sgd      none          none              0.732    0.791      0.732  0.732    0.718  0.746   0.732   0.736
gandalf  none          none              0.724    0.835      0.727  0.723    0.682  0.780   0.727   0.806
sgd      assoc         none              0.722    0.807      0.723  0.722    0.702  0.743   0.723   0.740
gandalf  assoc         none              0.720    0.841      0.722  0.720    0.683  0.766   0.722   0.785
gandalf  embed_linear  linear            0.718    0.835      0.719  0.718    0.696  0.741   0.719   0.740
lr       embed_lgbm    lgbm              0.700    0.710      0.706  0.692    0.636  0.833   0.706   0.888
rf       embed_lgbm    lgbm              0.682    0.724      0.684  0.681    0.647  0.728   0.684   0.756
lgbm     embed_lgbm    lgbm              0.670    0.717      0.672  0.670    0.642  0.703   0.672   0.719
sgd      embed_lgbm    lgbm              0.636    0.672      0.636  0.636    0.624  0.647   0.636   0.624
sgd      wrap          none              0.626    0.681      0.626  0.626    0.610  0.641   0.626   0.628
gandalf  embed_lgbm    lgbm              0.604    0.673      0.603  0.603    0.592  0.615   0.603   0.583
dummy    embed_lgbm    lgbm              0.578    0.500      0.578  0.578    0.561  0.596   0.578   0.591
knn      embed_linear  linear            0.574    0.573      0.572  0.571    0.567  0.580   0.572   0.508
knn      embed_lgbm    lgbm              0.554    0.545      0.551  0.547    0.548  0.558   0.551   0.446
knn      wrap          none              0.548    0.522      0.547  0.546    0.535  0.559   0.547   0.504
knn      pred          none              0.548    0.596      0.545  0.544    0.538  0.555   0.545   0.467
knn      assoc         none              0.536    0.539      0.536  0.536    0.520  0.552   0.536   0.537
knn      none          none              0.518    0.518      0.518  0.518    0.502  0.534   0.518   0.521
dummy    pred          none              0.516    0.500      0.500  0.340  nan      0.516   0.500   0.000
dummy    none          none              0.516    0.500      0.500  0.340  nan      0.516   0.500   0.000
dummy    assoc         none              0.516    0.500      0.500  0.340  nan      0.516   0.500   0.000
dummy    embed_linear  linear            0.496    0.504      0.495  0.495    0.478  0.511   0.495   0.459
dummy    wrap          none              0.494    0.500      0.494  0.494    0.478  0.510   0.494   0.504
gandalf  wrap          none              0.486    0.712      0.500  0.372    0.484  0.517   0.500   0.942

## 5-fold performance on holdout set

model    selection     embed_selector      acc    auroc    bal-acc     f1      npv    ppv    sens    spec
-------  ------------  ----------------  -----  -------  ---------  -----  -------  -----  ------  ------
sgd      none          none              0.756    0.811      0.757  0.755    0.745  0.778   0.757   0.765
lgbm     wrap          none              0.752    0.769      0.744  0.729    0.992  0.679   0.744   0.492
sgd      embed_linear  linear            0.750    0.755      0.751  0.748    0.733  0.784   0.751   0.778
rf       wrap          none              0.750    0.783      0.742  0.726    1.000  0.677   0.742   0.484
lr       wrap          none              0.748    0.772      0.741  0.728    0.952  0.680   0.741   0.505
lr       pred          none              0.746    0.859      0.745  0.743    0.777  0.736   0.745   0.687
lgbm     pred          none              0.744    0.841      0.743  0.742    0.751  0.747   0.743   0.707
lr       embed_linear  linear            0.742    0.866      0.742  0.739    0.750  0.750   0.742   0.720
rf       none          none              0.742    0.847      0.741  0.738    0.771  0.731   0.741   0.678
rf       pred          none              0.740    0.850      0.738  0.737    0.767  0.727   0.738   0.670
rf       embed_linear  linear            0.740    0.843      0.738  0.736    0.776  0.725   0.738   0.662
lr       assoc         none              0.740    0.862      0.740  0.737    0.753  0.742   0.740   0.703
lgbm     none          none              0.740    0.863      0.739  0.737    0.759  0.740   0.739   0.695
lr       none          none              0.738    0.863      0.737  0.735    0.753  0.739   0.737   0.699
lgbm     assoc         none              0.738    0.862      0.737  0.735    0.752  0.738   0.737   0.699
sgd      assoc         none              0.736    0.829      0.736  0.733    0.746  0.747   0.736   0.720
lgbm     embed_linear  linear            0.734    0.853      0.733  0.732    0.747  0.731   0.733   0.691
rf       assoc         none              0.732    0.852      0.732  0.729    0.735  0.742   0.732   0.707
sgd      pred          none              0.728    0.842      0.728  0.727    0.720  0.742   0.728   0.728
gandalf  embed_linear  linear            0.726    0.826      0.726  0.724    0.730  0.733   0.726   0.699
gandalf  none          none              0.708    0.821      0.709  0.704    0.699  0.736   0.709   0.712
gandalf  assoc         none              0.694    0.819      0.694  0.690    0.697  0.704   0.694   0.658
lr       embed_lgbm    lgbm              0.678    0.706      0.684  0.670    0.620  0.802   0.684   0.864
sgd      wrap          none              0.672    0.723      0.673  0.669    0.676  0.689   0.673   0.674
sgd      embed_lgbm    lgbm              0.662    0.701      0.664  0.660    0.636  0.700   0.664   0.715
rf       embed_lgbm    lgbm              0.660    0.705      0.664  0.657    0.623  0.722   0.664   0.765
gandalf  pred          none              0.658    0.825      0.651  0.594    0.795  0.665   0.651   0.465
gandalf  embed_lgbm    lgbm              0.656    0.693      0.659  0.653    0.627  0.711   0.659   0.728
lgbm     embed_lgbm    lgbm              0.652    0.699      0.655  0.650    0.621  0.703   0.655   0.716
gandalf  wrap          none              0.626    0.702      0.622  0.527    0.852  0.699   0.622   0.448
knn      pred          none              0.548    0.546      0.541  0.521    0.559  0.544   0.541   0.322
knn      embed_lgbm    lgbm              0.528    0.528      0.521  0.492    0.527  0.530   0.521   0.281
knn      wrap          none              0.520    0.539      0.518  0.515    0.503  0.533   0.518   0.446
dummy    none          none              0.516    0.500      0.500  0.340  nan      0.516   0.500   0.000
dummy    pred          none              0.516    0.500      0.500  0.340  nan      0.516   0.500   0.000
dummy    assoc         none              0.516    0.500      0.500  0.340  nan      0.516   0.500   0.000
knn      embed_linear  linear            0.504    0.529      0.500  0.489    0.492  0.513   0.500   0.372
knn      none          none              0.504    0.529      0.503  0.501    0.485  0.521   0.503   0.463
knn      assoc         none              0.500    0.546      0.499  0.496    0.481  0.516   0.499   0.467
dummy    embed_lgbm    lgbm              0.494    0.500      0.494  0.493    0.481  0.507   0.494   0.500
dummy    embed_linear  linear            0.486    0.559      0.486  0.486    0.470  0.502   0.486   0.483
dummy    wrap          none              0.480    0.500      0.480  0.478    0.462  0.496   0.480   0.467

